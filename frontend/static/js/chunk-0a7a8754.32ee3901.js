(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a7a8754"],{"16f8":function(e,t,a){},a829:function(e,t,a){"use strict";var i=a("16f8"),n=a.n(i);n.a},f1ab:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{ref:e.metadata.columnName,class:e.classStyle+" "+e.metadata.cssClassName,attrs:{filterable:!e.isMobile,placeholder:e.metadata.help,loading:e.isLoading,"value-key":"key",clearable:"",multiple:e.isSelectMultiple,"allow-create":e.metadata.isSelectCreated,"collapse-tags":!e.isSelectMultiple,disabled:e.isDisabled},on:{change:e.preHandleChange,"visible-change":e.getDataLookupList,clear:e.clearLookup},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e,t){return a("el-option",{key:t,attrs:{value:e.key,label:e.label}})})),1)},n=[],s=(a("7db0"),a("caad"),a("45fc"),a("a9e3"),a("d3b7"),a("2532"),a("96cf"),a("1da1")),l=a("2874"),u={name:"FieldSelect",mixins:[l["a"]],data:function(){return{isLoading:!1,options:[{label:" ",key:void 0}],blankValues:[null,void 0,-1],blankOption:{label:" ",key:void 0}}},computed:{isPanelWindow:function(){return"window"===this.metadata.panelType},isMobile:function(){return"mobile"===this.$store.state.app.device},isSelectMultiple:function(){return["IN","NOT_IN"].includes(this.metadata.operator)&&this.metadata.isAdvancedQuery},classStyle:function(){var e="custom-field-select";return this.isSelectMultiple&&(e+=" custom-field-select-multiple"),e},getterLookupList:function(){return this.isEmptyValue(this.metadata.reference.query)||!this.metadata.displayed?[this.blankOption]:this.$store.getters.getLookupList({parentUuid:this.metadata.parentUuid,containerUuid:this.metadata.containerUuid,query:this.metadata.reference.query,tableName:this.metadata.reference.tableName})},getterLookupAll:function(){var e=this.$store.getters.getLookupAll({parentUuid:this.metadata.parentUuid,containerUuid:this.metadata.containerUuid,query:this.metadata.reference.query,directQuery:this.metadata.reference.directQuery,tableName:this.metadata.reference.tableName,value:this.value});return(this.isEmptyValue(e)||e.length&&!this.blankValues.includes(e[0].key))&&e.unshift(this.blankOption),e}},watch:{isSelectMultiple:function(e){if(e){var t=[];this.isEmptyValue(this.value)||t.push(this.value),this.value=t}else Array.isArray(this.value)&&(this.value.length?this.value=this.value[0]:this.value=void 0)},valueModel:function(e){this.metadata.inTable&&(this.value=e)},"metadata.value":function(e){this.metadata.inTable||("boolean"===typeof e&&(e=e?"Y":"N"),this.metadata.displayed&&(this.options.some((function(t){return t.key===e}))||this.isEmptyValue(this.metadata.displayColumn)||this.options.push({key:e,label:this.metadata.displayColumn})),!this.findLabel(e)&&this.metadata.displayed&&this.isEmptyValue(this.metadata.displayColumn)&&(e=void 0),this.value=e)},"metadata.displayColumn":function(e){this.metadata.displayed&&(this.isEmptyValue(this.value)||this.isEmptyValue(e)||this.findLabel(this.value)||this.options.push({key:this.value,label:e}))},"metadata.displayed":function(e){e&&(this.changeBlankOption(),this.options=this.getterLookupAll)}},beforeMount:function(){this.metadata.displayed&&(this.changeBlankOption(),this.options=this.getterLookupAll,this.isEmptyValue(this.value)||this.metadata.isAdvancedQuery||this.findLabel(this.value)||(this.isEmptyValue(this.metadata.displayColumn)?(!this.isPanelWindow||this.isPanelWindow&&(this.isEmptyValue(this.metadata.optionCRUD)||"create-new"===this.metadata.optionCRUD))&&this.getDataLookupItem():this.options.push({key:this.value,label:this.metadata.displayColumn})))},methods:{changeBlankOption:function(){-1===Number(this.metadata.defaultValue)&&(this.blankOption={label:" ",key:-1}),void 0!==this.value&&null!==this.value||(this.blankOption={label:" ",key:void 0})},preHandleChange:function(e){var t=this.findLabel(this.value);this.handleChange(e,void 0,t)},findLabel:function(e){var t=this.options.find((function(t){return t.key===e}));return t?t.label:t},getDataLookupItem:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.isEmptyValue(e.metadata.reference.directQuery)||e.metadata.isAdvancedQuery&&e.isSelectMultiple)){t.next=2;break}return t.abrupt("return");case 2:e.isLoading=!0,e.$store.dispatch("getLookupItemFromServer",{parentUuid:e.metadata.parentUuid,containerUuid:e.metadata.containerUuid,tableName:e.metadata.reference.tableName,directQuery:e.metadata.reference.directQuery,value:e.metadata.value}).then((function(t){e.isPanelWindow&&e.$store.dispatch("changeFieldAttribure",{containerUuid:e.metadata.containerUuid,isAdvancedQuery:e.metadata.isAdvancedQuery,columnName:e.metadata.columnName,attributeName:"displayColumn",attributeValue:t.label}),e.changeBlankOption(),e.options=e.getterLookupAll})).finally((function(){e.isLoading=!1}));case 4:case"end":return t.stop()}}),t)})))()},getDataLookupList:function(e){if(e){var t=this.getterLookupList;(this.isEmptyValue(t)||1===t.length&&this.blankValues.includes(t[0]))&&this.remoteMethod()}},remoteMethod:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isEmptyValue(e.metadata.reference.query)){t.next=2;break}return t.abrupt("return");case 2:e.isLoading=!0,e.$store.dispatch("getLookupListFromServer",{parentUuid:e.metadata.parentUuid,containerUuid:e.metadata.containerUuid,tableName:e.metadata.reference.tableName,query:e.metadata.reference.query}).then((function(t){e.changeBlankOption(),e.options=e.getterLookupAll})).finally((function(){e.isLoading=!1}));case 4:case"end":return t.stop()}}),t)})))()},clearLookup:function(){this.$store.dispatch("deleteLookupList",{parentUuid:this.metadata.parentUuid,containerUuid:this.metadata.containerUuid,tableName:this.metadata.reference.tableName,query:this.metadata.reference.query,directQuery:this.metadata.reference.directQuery,value:this.value}),this.changeBlankOption();var e=[];e.push(this.blankOption),this.options=e,this.value=this.blankOption.key}}},r=u,o=(a("a829"),a("2877")),d=Object(o["a"])(r,i,n,!1,null,null,null);t["default"]=d.exports}}]);